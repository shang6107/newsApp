<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security"
             xmlns:beans="http://www.springframework.org/schema/beans"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xmlns:p="http://www.springframework.org/schema/p"
             xsi:schemaLocation="
             http://www.springframework.org/schema/beans
             http://www.springframework.org/schema/beans/spring-beans.xsd
             http://www.springframework.org/schema/security
             http://www.springframework.org/schema/security/spring-security.xsd">
    <!-- 配置用户相关权限 -->

    <http auto-config="true" use-expressions="true">
        <!--<intercept-url pattern="/**" access="hasAnyRole('用户管理员')"/>-->
        <intercept-url pattern="/" access="permitAll"/>
        <intercept-url pattern="/app**" access="isAnonymous()"/>
        <intercept-url pattern="/static**" access="permitAll"/>
        <intercept-url pattern="/root**" access="hasRole('超级管理员')" />
        <intercept-url pattern="/user**" access="hasRole('超级管理员') or hasRole('用户管理员')" />
        <intercept-url pattern="/news**" access="hasRole('超级管理员') or hasRole('新闻管理员')" />
        <form-login  login-page="/login"
                     username-parameter="mgrNo"
                     password-parameter="password"
                     authentication-failure-forward-url="/login?error"
                     authentication-success-handler-ref="authenticationSuccessHandler"
                     />
        <access-denied-handler error-page="/403.html"/>
        <!--<session-management invalid-session-url="/login"/>-->
    </http>
    <authentication-manager>
        <authentication-provider user-service-ref="customManagerDetailsService"/>
    </authentication-manager>
</beans:beans>