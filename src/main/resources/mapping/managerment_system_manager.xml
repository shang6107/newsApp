<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cxgc.news_app.core.mapper.managerment_system_mapper.ManagerDao">


    <resultMap id="manager_result" type="manager">
        <id property="id" column="id"/>
        <result property="mgrNo" column="mgr_no"/>
        <result property="password" column="password"/>
        <result property="mgrName" column="mgr_name"/>
        <result property="lastTime" column="last_time"/>
        <result property="createTime" column="create_time"/>
        <result property="remoteAddress" column="remote_address"/>
        <result property="loginCount" column="login_count"/>
        <association property="groups" column="groups_id"
                     select="com.cxgc.news_app.core.mapper.managerment_system_mapper.GroupDao.getGroupById"/>
    </resultMap>


    <select id="getManagerByMgrNo" resultMap="manager_result">
        select * from manager where mgr_no = #{0}
    </select>
    <insert id="addManager" parameterType="com.cxgc.news_app.core.model.Manager">
        insert into manager (id,mgr_no,password,mgr_name,groups_id) VALUES ()<!--//TODO:ï¼Ÿ-->
    </insert>


    <select id="selectAllManager" resultMap="manager_result">
        select * from manager where mgr_no != m001
    </select>
    <update id="updateLastLoginTimeAndAddressAndLoginCount">
        update manager set last_time = now(),login_count = login_count + 1 , remote_address = #{1} where mgr_no = #{0}
    </update>

</mapper>
